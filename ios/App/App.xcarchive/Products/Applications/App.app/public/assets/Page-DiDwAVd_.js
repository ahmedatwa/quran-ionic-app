import{d as G,u as J,B as me,a5 as M,a6 as Z,A as T,Q as R,a7 as fe,a8 as Y,a9 as _e,o as s,f as c,b as a,w as t,F as N,r as A,c as j,s as q,a as e,aa as ee,v as V,ab as ae,ac as te,j as O,k as C,t as p,ad as x,ae as be,af as ve,ag as he,ah as ye,g as ke,ai as ne,aj as se,ak as F,q as Ie,al as ie,am as $e,l as we,an as le,ao as oe,i as W,J as re,ap as ue,aq as de,m as Q,ar as Ce,K as ze,a0 as Pe,as as Ve,D as Se,at as Be,a1 as Te,au as Re,av as X,a4 as Ne,n as Ae,aw as xe}from"./index-CSnR3WyL.js";import{_ as ce,a as Le,v as je,s as qe,b as Oe,A as De}from"./ChapterInfoModalComponent.vue_vue_type_script_setup_true_lang-R2QvnKQV.js";import{u as K,p as Ue}from"./string-BRzLPHJq.js";import{u as pe,a as Fe}from"./ChapterStore-BzKdIpaO.js";import{u as He}from"./PageStore-qefXKcyO.js";import{a as Ke,u as Ee}from"./ModalComponent.vue_vue_type_script_setup_true_lang-BWKJX5VG.js";import"./_plugin-vue_export-helper-5Z20xKf-.js";const We=["id"],Ge={class:"d-flex ion-justify-content-between"},Je=q("hr",null,null,-1),Me={key:0,class:"end"},Qe=["innerHTML"],Ye={key:0,class:"ion-margin-top"},Xe=G({__name:"TranslationsViewComponent",props:{id:{},isTranslationsView:{type:Boolean},isPlaying:{type:Boolean},isLoading:{type:Boolean},translatedBy:{},chapterName:{},isBismillah:{},verses:{},pagination:{},verseTiming:{},styles:{}},emits:["update:getVerses","update:playAudio","update:modalValue"],setup(H,{emit:S}){const{getLine:l}=J(),{getChapterNameByFirstVerse:B,getChapterName:k}=pe(),{setStorage:I,bookmarkedItems:_}=me("__bookmarksDB"),{params:D}=M(),L=Z(),$=T(),b=R(()=>Number(D.pageId)),u=T(),g=H,z=S,w=([{isIntersecting:n,target:m,intersectionRatio:h}])=>{if(n&&h>=.8){const P=Number(m.getAttribute("data-verse-number"));u.value=P}};fe(u,n=>{n&&qe("#verse-col-".concat(n),$.value.$el,300)});const d=async n=>{var m;_.value.push({key:"/page/".concat(n.page_number),value:{pageNumber:n.page_number,verseNumber:n.verse_number,verseText:n.text_uthmani,chapterName:(m=k(n.chapter_id))==null?void 0:m.nameSimple}}),_.value.forEach(({key:h,value:P})=>{I(h,P)})},v=n=>{var m;(m=g.pagination)!=null&&m.next_page?(z("update:getVerses",{key:g.id,nextPage:g.pagination.next_page}),setTimeout(()=>n.target.complete(),500)):n.target.complete()},E=n=>{if(g.verseTiming)return g.verseTiming.wordLocation===n.location},U=R(()=>L.options.history.state.back?K(L.options.history.state.back.toString().substring(1)):K(l("tabs.pages")));return(n,m)=>Y((s(),c("div",{class:"ion-page",id:"translations-".concat(n.id,"-").concat(b.value)},[a(ce,{"route-back-label":U.value,"is-loading":n.isLoading},null,8,["route-back-label","is-loading"]),a(e(Q),{class:"quran-translation-content-wapper",fullscreen:!0,scrollY:!0,ref:"contentRef"},{default:t(()=>[(s(!0),c(N,null,A(n.verses,(h,P)=>(s(),j(e(re),{class:"ion-padding card-wrapper",key:P,id:"card-".concat(P),ref_for:!0,ref_key:"cardRef",ref:$},{default:t(()=>[q("div",Ge,[a(e(ee),{onClick:i=>n.$emit("update:playAudio",{audioID:h[0].chapter_id,verseKey:h[0].verse_key}),color:"primary"},{default:t(()=>[a(e(V),{icon:n.isPlaying?e(ae):e(te)},null,8,["icon"]),a(e(O),null,{default:t(()=>[C(p(e(l)("quranReader.buttonPlay")),1)]),_:1})]),_:2},1032,["onClick"]),a(e(x),{onClick:m[0]||(m[0]=i=>n.$emit("update:modalValue",!0)),fill:"clear"},{default:t(()=>[a(e(V),{icon:e(be),slot:"icon-only"},null,8,["icon"])]),_:1})]),a(e(ve),{class:"ion-text-center"},{default:t(()=>[a(e(he),null,{default:t(()=>{var i;return[C(p((i=e(B)(h[0]))==null?void 0:i.nameArabic),1)]}),_:2},1024),a(e(ye),null,{default:t(()=>{var i;return[C(p((i=e(B)(h[0]))!=null&&i.bismillahPre?e(l)("quranReader.textBismillah"):""),1)]}),_:2},1024)]),_:2},1024),Je,(s(!0),c(N,null,A(h,i=>Y((s(),j(e(ke),{key:i.verse_number,"data-verse-number":i.verse_number,"data-hizb-number":i.hizb_number,"data-juz-number":i.juz_number,id:"verse-col-".concat(i.verse_number)},{default:t(()=>[a(e(ne),null,{default:t(()=>[a(e(se),{class:"ion-align-items-start"},{default:t(()=>[a(e(F),{size:"11",class:"translations-view-col"},{default:t(()=>[(s(!0),c(N,null,A(i.words,y=>(s(),j(e(O),{key:y.id,class:"word"},{default:t(()=>[a(e(Ie),{color:E(y)?"primary":""},{default:t(()=>[y.char_type_name==="end"?(s(),c("h3",Me," ("+p(y.text_uthmani)+")",1)):(s(),c("h3",{key:1,style:ie(n.styles)},p(y.text_uthmani),5))]),_:2},1032,["color"])]),_:2},1024))),128))]),_:2},1024),a(e(F),{size:"1",class:"action-sheet"},{default:t(()=>[a(e(V),{icon:e($e),color:"primary",id:"open-action-sheet".concat(i.verse_number)},null,8,["icon","id"]),a(Le,{verse:i,"trigger-prop":"open-action-sheet".concat(i.verse_number),"onUpdate:bookmarked":d,"onUpdate:playVerseAudio":m[1]||(m[1]=y=>n.$emit("update:playAudio",y))},null,8,["verse","trigger-prop"])]),_:2},1024),a(e(F),{size:"12",class:"ion-text-left"},{default:t(()=>[(s(!0),c(N,null,A(i.translations,y=>(s(),j(e(we),{key:y.id,class:"translation"},{default:t(()=>[q("span",{innerHTML:y.text},null,8,Qe)]),_:2},1024))),128))]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1032,["data-verse-number","data-hizb-number","data-juz-number","id"])),[[e(je),[w,{root:$.value,immediate:!1}]]])),128)),b.value?(s(),c("div",Ye,[a(e(x),{size:"small",fill:"clear",disabled:b.value===1,"router-link":"/page/".concat(b.value-1)},{default:t(()=>[a(e(V),{icon:e(le),slot:"start"},null,8,["icon"]),C(" "+p(e(l)("quranReader.prevPage")),1)]),_:1},8,["disabled","router-link"]),a(e(x),{size:"small",fill:"clear",disabled:b.value===604,class:"ion-float-right","router-link":"/page/".concat(b.value+1)},{default:t(()=>[a(e(V),{icon:e(oe),slot:"start"},null,8,["icon"]),C(" "+p(e(l)("quranReader.nextPage")),1)]),_:1},8,["disabled","router-link"])])):W("",!0)]),_:2},1032,["id"]))),128)),a(e(ue),{onIonInfinite:v},{default:t(()=>[a(e(de),{"loading-text":"Please wait...","loading-spinner":"bubbles"})]),_:1})]),_:1},512)],8,We)),[[_e,n.isTranslationsView]])}}),Ze=["id"],ea={class:"d-flex ion-justify-content-between"},aa=["id","data-hizb-number","data-chapter-id","data-juz-number","data-page-number","data-verse-number"],ta=["data-word-position","data-hizb-number","data-juz-number","data-chapter-id","data-page-number"],na={key:0,class:"end"},sa={key:0,class:"ion-margin-top"},ia=G({__name:"ReadingViewComponent",props:{id:{},isReadingView:{type:Boolean},isPlaying:{type:Boolean},verseTiming:{},verses:{},isLoading:{type:Boolean},pagination:{},styles:{}},emits:["update:getv","update:playAudio","update:surahInfo"],setup(H,{emit:S}){const l=M(),B=Z(),{getLine:k}=J(),I=R(()=>Number(l.params.pageId)),_=H,D=S,L=(u,g)=>{if(_.isReadingView&&_.verseTiming)return _.verseTiming.wordLocation===u&&g===_.verseTiming.verseKey},$=u=>{var g;(g=_.pagination)!=null&&g.next_page?(D("update:getv",{key:_.id,nextPage:_.pagination.next_page}),setTimeout(()=>u.target.complete(),500)):u.target.complete()},b=R(()=>B.options.history.state.back?K(B.options.history.state.back.toString().substring(1)):K(k("tabs.pages")));return(u,g)=>u.isReadingView?(s(),c("div",{key:0,class:"ion-page",id:"".concat(u.id,"-").concat(I.value)},[a(ce,{"is-loading":u.isLoading,"route-back-label":b.value},null,8,["is-loading","route-back-label"]),a(e(Q),null,{default:t(()=>[(s(!0),c(N,null,A(u.verses,(z,w)=>(s(),j(e(re),{class:"ion-padding",key:w,id:"row-page-".concat(w)},{default:t(()=>[q("div",ea,[a(e(ee),{onClick:d=>u.$emit("update:playAudio",{audioID:z[0].chapter_id,verseKey:z[0].verse_key}),color:"primary"},{default:t(()=>[a(e(V),{icon:u.isPlaying?e(ae):e(te)},null,8,["icon"]),a(e(O),null,{default:t(()=>[C(p(e(k)("quranReader.buttonPlay")),1)]),_:1})]),_:2},1032,["onClick"]),a(e(x),{fill:"clear",onClick:d=>u.$emit("update:surahInfo",z[0].chapter_id)},{default:t(()=>[a(e(V),{icon:e(Ce),slot:"icon-only"},null,8,["icon"])]),_:2},1032,["onClick"])]),a(e(ze),{class:"ion-padding quran-reader-content-wrapper"},{default:t(()=>[a(e(ne),null,{default:t(()=>[a(e(se),null,{default:t(()=>[a(e(F),{class:"verse-col",id:"page-".concat(w),size:"12"},{default:t(()=>[(s(!0),c(N,null,A(z,d=>(s(),c("div",{class:"word-wrapper",key:d.id,id:"line-".concat(d.verse_number),"data-hizb-number":d.hizb_number,"data-chapter-id":d.chapter_id,"data-juz-number":d.juz_number,"data-page-number":w,"data-verse-number":d.verse_number},[(s(!0),c(N,null,A(d.words,v=>(s(),c("div",{key:v.id,"data-word-position":v.position,class:"flex","data-hizb-number":d.hizb_number,"data-juz-number":d.juz_number,"data-chapter-id":d.chapter_id,"data-page-number":w},[q("span",{class:Pe([L(v.location,v.verse_key)?"text-blue":"","word"])},[v.char_type_name==="end"?(s(),c("div",na,"("+p(v.text_uthmani)+") ",1)):(s(),c("h3",{key:1,style:ie(u.styles)},p(v.text_uthmani),5))],2)],8,ta))),128))],8,aa))),128))]),_:2},1032,["id"]),a(e(F),{size:"12"},{default:t(()=>[a(e(Ve),null,{default:t(()=>[a(e(O),{class:"m-auto"},{default:t(()=>[C(p(e(k)("quranReader.textPage"))+" "+p(w),1)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024),I.value?(s(),c("div",sa,[a(e(x),{size:"small",fill:"clear",disabled:I.value===1,"router-link":"/page/".concat(I.value-1)},{default:t(()=>[a(e(V),{icon:e(le),slot:"start"},null,8,["icon"]),C(" "+p(e(k)("quranReader.prevPage")),1)]),_:1},8,["disabled","router-link"]),a(e(x),{size:"small",fill:"clear",disabled:I.value===604,class:"ion-float-right","router-link":"/page/".concat(I.value+1)},{default:t(()=>[a(e(V),{icon:e(oe),slot:"start"},null,8,["icon"]),C(" "+p(e(k)("quranReader.nextPage")),1)]),_:1},8,["disabled","router-link"])])):W("",!0)]),_:2},1032,["id"]))),128)),a(e(ue),{onIonInfinite:$},{default:t(()=>[a(e(de),{"loading-text":"Please wait...","loading-spinner":"bubbles"})]),_:1})]),_:1})],8,Ze)):W("",!0)}}),ga=G({__name:"Page",setup(H){const S=T("translations"),l=He(),{getLine:B}=J(),k=Ke(),I=Fe(),{selectedChapterName:_,selectedChapterBismillah:D,getchapterInfo:L}=pe(),$=Ee(),b=T(!1),u=o=>{S.value=o.detail.value},g=R(()=>{var o;return(o=l.selectedPage)==null?void 0:o.pagination}),z=T(),w=T(),d=T(null),v=T(),E=M(),{pageId:U}=E.params;Se(async()=>{var o;if(U){l.selectedPage=null;const r=l.pagesList.find(f=>f.pageNumber===Number(U));r&&((o=r.verses)!=null&&o.length?l.selectedPage=r:await l.getVerses(r.pageNumber,!0))}});const n=async o=>{await $.getAudio({audioID:o.audioID,verseKey:o.verseKey}),b.value=!0},m=async o=>{var r,f;o.nextPage&&l.selectedPage&&await l.getVerses((r=l.selectedPage)==null?void 0:r.pageNumber,!0,(f=g.value)==null?void 0:f.next_page)},h=R(()=>({fontFamily:"var(--font-family-".concat(k.styles.value.fontFamily,")"),fontSize:"var(--font-size-".concat(k.styles.value.fontSize,")"),fontWeight:"var(--font-weight-".concat(k.styles.value.fontWeight,")")})),P=R(()=>{if(l.selectedPage)return l.selectedPage.verses}),i=R(()=>{var o;if(P.value)return(o=P.value)==null?void 0:o.reduce((r,f)=>((r[f.chapter_id]=r[f.chapter_id]||[]).push(f),r),{})}),y=async o=>{await L(o).then(r=>{d.value=r.data.chapter_info}),v.value.$el.click()},ge=async()=>{var r,f;await(await xe.create({header:Ue(String((r=I.selectedTranslation)==null?void 0:r.language_name)),message:(f=I.selectedTranslation)==null?void 0:f.author_name,id:"translation-alert",buttons:["Ok"]})).present()};return Be(()=>w.value=z.value.$el),(o,r)=>(s(),j(e(Ae),{"data-page-id":e(U),ref_key:"pageRef",ref:z},{default:t(()=>[a(e(Ne),null,{default:t(()=>[a(e(Te),null,{default:t(()=>[a(e(Re),{value:S.value,onIonChange:u},{default:t(()=>[a(e(X),{value:"translations"},{default:t(()=>[a(e(O),null,{default:t(()=>[C(p(e(B)("tabs.translations")),1)]),_:1})]),_:1}),a(e(X),{value:"reading"},{default:t(()=>[a(e(O),null,{default:t(()=>[C(p(e(B)("tabs.reading")),1)]),_:1})]),_:1})]),_:1},8,["value"])]),_:1})]),_:1}),a(e(Q),null,{default:t(()=>[a(Xe,{id:"translations-pages","is-loading":e(l).isLoading,"is-playing":e($).isPlaying,"is-translations-view":S.value==="translations","onUpdate:playAudio":n,"is-bismillah":e(D),styles:h.value,verses:i.value,"chapter-name":e(_).nameArabic,"onUpdate:modalValue":ge,"verse-timing":e($).verseTiming,"onUpdate:getVerses":m,pagination:g.value},null,8,["is-loading","is-playing","is-translations-view","is-bismillah","styles","verses","chapter-name","verse-timing","pagination"]),a(ia,{id:"reading-pages","is-reading-view":S.value==="reading","is-playing":e($).isPlaying,verses:i.value,"onUpdate:playAudio":n,"onUpdate:surahInfo":y,"is-loading":e(l).isLoading,styles:h.value,"verse-timing":e($).verseTiming,"onUpdate:getVerses":m,pagination:g.value},null,8,["is-reading-view","is-playing","verses","is-loading","styles","verse-timing","pagination"]),q("div",null,[a(e(x),{ref_key:"chapterInfoButtonRef",ref:v,id:"page-chapter-modal",class:"ion-hide"},null,512),a(Oe,{trigger:"page-chapter-modal","chapter-info":d.value,"page-el":w.value},null,8,["chapter-info","page-el"])])]),_:1}),a(De,{"model-value":b.value,"onUpdate:modelValue":r[0]||(r[0]=f=>b.value=f)},null,8,["model-value"])]),_:1},8,["data-page-id"]))}});export{ga as default};
