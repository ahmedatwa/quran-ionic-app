import{d as q,u as O,a5 as E,B as oe,A as C,Q as N,D as G,a7 as re,a8 as K,a9 as ue,o as u,f,b as a,a as e,w as t,J,s as P,aa as Q,v as L,ab as Y,ac as X,j as A,k as $,t as _,ad as H,ae as de,af as Z,ag as ee,ah as ae,F as R,r as x,c as j,ai as ce,aj as pe,ak as U,q as me,al as te,am as ge,l as fe,g as _e,ap as ne,aq as se,m as M,ar as he,K as be,a0 as ve,as as ye,i as Ie,at as ke,a1 as Ce,au as $e,av as W,a4 as we,n as Ve,aw as ze}from"./index-CSnR3WyL.js";import{_ as ie,a as Te,v as Se,s as Be,b as Pe,A as Ne}from"./ChapterInfoModalComponent.vue_vue_type_script_setup_true_lang-R2QvnKQV.js";import{u as F,a as Re}from"./ChapterStore-BzKdIpaO.js";import{u as xe,a as Ae}from"./ModalComponent.vue_vue_type_script_setup_true_lang-BWKJX5VG.js";import{p as Le}from"./string-BRzLPHJq.js";import"./_plugin-vue_export-helper-5Z20xKf-.js";const je=["id"],De={class:"d-flex ion-justify-content-between"},Ue={key:0,class:"end"},qe=["innerHTML"],Oe=q({__name:"TranslationsViewComponent",props:{id:{},isTranslationsView:{type:Boolean},isPlaying:{type:Boolean},isLoading:{type:Boolean},chapterName:{},isBismillah:{},verses:{},audioExperience:{},pagination:{},verseTiming:{},styles:{}},emits:["update:getVerses","update:playAudio","update:modalValue"],setup(D,{emit:w}){const{getLine:o}=O(),{params:b}=E(),{setStorage:I,bookmarkedItems:T}=oe("__bookmarksDB"),{getChapterName:m}=F(),S=C(),V=C(),B=N(()=>Number(b.chapterId)),k=C(),s=D,g=w,v=([{isIntersecting:n,target:d,intersectionRatio:l}])=>{if(n&&l>=.8){const p=Number(d.getAttribute("data-verse-number"));k.value=p}};G(async()=>{var n;s.audioExperience.autoScroll&&(k.value=Number((n=s.verseTiming)==null?void 0:n.verseNumber))}),re(k,n=>{n&&Be("#verse-col-".concat(n),V.value.$el,300)});const y=async n=>{var d;T.value.push({key:"/page/".concat(n.page_number),value:{pageNumber:n.page_number,verseNumber:n.verse_number,verseText:n.text_uthmani,chapterName:(d=m(n.chapter_id))==null?void 0:d.nameSimple}}),T.value.forEach(({key:l,value:p})=>{I(l,p)})},i=n=>{var d;(d=s.pagination)!=null&&d.next_page?(g("update:getVerses",{key:s.id,nextPage:s.pagination.next_page}),setTimeout(()=>n.target.complete(),500)):n.target.complete()},h=n=>{if(s.verseTiming)return s.verseTiming.wordLocation===n.location};return(n,d)=>K((u(),f("div",{class:"ion-page",id:"translations-".concat(n.id,"-").concat(B.value)},[a(ie,{"route-back-label":e(o)("tabs.chapters"),"is-loading":n.isLoading},null,8,["route-back-label","is-loading"]),a(e(M),{class:"quran-translation-content-wapper",fullscreen:!0,scrollY:!0,ref_key:"contentRef",ref:S},{default:t(()=>[a(e(J),{class:"ion-padding card-wrapper",ref_key:"cardRef",ref:V},{default:t(()=>[P("div",De,[a(e(Q),{onClick:d[0]||(d[0]=l=>n.$emit("update:playAudio",{audioID:B.value})),color:"primary"},{default:t(()=>[a(e(L),{color:"primary",icon:n.isPlaying?e(Y):e(X)},null,8,["icon"]),a(e(A),null,{default:t(()=>[$(_(e(o)("quranReader.buttonPlay")),1)]),_:1})]),_:1}),a(e(H),{onClick:d[1]||(d[1]=l=>n.$emit("update:modalValue",!0)),fill:"clear"},{default:t(()=>[a(e(L),{icon:e(de),slot:"icon-only"},null,8,["icon"])]),_:1})]),a(e(Z),{class:"ion-text-center"},{default:t(()=>[a(e(ee),null,{default:t(()=>[$(_(n.chapterName),1)]),_:1}),a(e(ae),null,{default:t(()=>[$(_(n.isBismillah),1)]),_:1})]),_:1}),(u(!0),f(R,null,x(n.verses,l=>K((u(),j(e(_e),{key:l.verse_number,"data-verse-number":l.verse_number,"data-hizb-number":l.hizb_number,"data-juz-number":l.juz_number,id:"verse-col-".concat(l.verse_number)},{default:t(()=>[a(e(ce),null,{default:t(()=>[a(e(pe),{class:"ion-align-items-start"},{default:t(()=>[a(e(U),{size:"11",class:"translations-view-col"},{default:t(()=>[(u(!0),f(R,null,x(l.words,p=>(u(),j(e(A),{key:p.id},{default:t(()=>[a(e(me),{color:h(p)?"primary":"",id:"word-".concat(l.verse_number)},{default:t(()=>[p.char_type_name==="end"?(u(),f("span",Ue," ("+_(p.text_uthmani)+")",1)):(u(),f("h3",{key:1,style:te(n.styles)},_(p.text_uthmani),5))]),_:2},1032,["color","id"])]),_:2},1024))),128))]),_:2},1024),a(e(U),{size:"1",class:"action-sheet"},{default:t(()=>[a(e(L),{icon:e(ge),color:"primary",id:"open-action-sheet".concat(l.verse_number)},null,8,["icon","id"]),a(Te,{verse:l,"trigger-prop":"open-action-sheet".concat(l.verse_number),"onUpdate:bookmarked":y,"onUpdate:playVerseAudio":d[2]||(d[2]=p=>n.$emit("update:playAudio",{...p}))},null,8,["verse","trigger-prop"])]),_:2},1024),a(e(U),{size:"12",class:"ion-text-left"},{default:t(()=>[(u(!0),f(R,null,x(l.translations,p=>(u(),j(e(fe),{key:p.id,class:"translation"},{default:t(()=>[P("span",{innerHTML:p.text},null,8,qe)]),_:2},1024))),128))]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1032,["data-verse-number","data-hizb-number","data-juz-number","id"])),[[e(Se),[v,{root:S.value,immediate:!1}]]])),128))]),_:1},512),a(e(ne),{onIonInfinite:i},{default:t(()=>[a(e(se),{"loading-text":"Please wait...","loading-spinner":"bubbles"})]),_:1})]),_:1},512)],8,je)),[[ue,n.isTranslationsView]])}}),Ee=["id"],He={class:"d-flex ion-justify-content-between"},Me=["id"],Fe=["id","data-hizb-number","data-chapter-id","data-juz-number","data-page-number","data-verse-number"],Ke=["data-word-position","data-hizb-number","data-juz-number","data-chapter-id","data-page-number"],We={key:0,class:"end"},Ge=q({__name:"ReadingViewComponent",props:{id:{},isReadingView:{type:Boolean},isPlaying:{type:Boolean},verseTiming:{},verses:{},isLoading:{type:Boolean},pagination:{},styles:{}},emits:["update:getVerses","update:playAudio","update:surahInfo"],setup(D,{emit:w}){const{params:o}=E(),{getChapterNameByFirstVerse:b}=F(),{getLine:I}=O(),T=N(()=>Number(o.chapterId)),m=D,S=w,V=N(()=>{if(m.verses)return m.verses.reduce((s,g)=>((s[g.page_number]=s[g.page_number]||[]).push(g),s),{})}),B=(s,g)=>{if(m.isReadingView&&m.verseTiming)return m.verseTiming.wordLocation===s&&g===m.verseTiming.verseKey},k=s=>{var g;(g=m.pagination)!=null&&g.next_page?(S("update:getVerses",{key:m.id,nextPage:m.pagination.next_page}),setTimeout(()=>s.target.complete(),500)):s.target.complete()};return(s,g)=>s.isReadingView?(u(),f("div",{key:0,class:"ion-page",id:"".concat(s.id,"-").concat(T.value)},[a(ie,{"is-loading":s.isLoading,"route-back-label":e(I)("tabs.chapters")},null,8,["is-loading","route-back-label"]),a(e(M),null,{default:t(()=>[(u(!0),f(R,null,x(V.value,(v,y)=>(u(),j(e(J),{class:"ion-padding",key:y,id:"row-page-".concat(y)},{default:t(()=>[P("div",He,[a(e(Q),{onClick:i=>s.$emit("update:playAudio",{audioID:v[0].chapter_id}),color:"primary"},{default:t(()=>[a(e(L),{icon:s.isPlaying?e(Y):e(X)},null,8,["icon"]),a(e(A),null,{default:t(()=>[$(_(e(I)("quranReader.buttonPlay")),1)]),_:1})]),_:2},1032,["onClick"]),a(e(H),{fill:"clear",onClick:i=>s.$emit("update:surahInfo",v[0].chapter_id)},{default:t(()=>[a(e(L),{icon:e(he),slot:"icon-only"},null,8,["icon"])]),_:2},1032,["onClick"])]),a(e(Z),{class:"ion-text-center"},{default:t(()=>[a(e(ae),null,{default:t(()=>{var i;return[$(_((i=e(b)(v[0]))!=null&&i.bismillahPre?e(I)("quranReader.textBismillah"):""),1)]}),_:2},1024),a(e(ee),null,{default:t(()=>{var i;return[$(_((i=e(b)(v[0]))==null?void 0:i.nameArabic),1)]}),_:2},1024)]),_:2},1024),a(e(be),{class:"ion-padding quran-reader-content-wrapper"},{default:t(()=>[P("div",{class:"verse-col",id:"page-".concat(y),size:"12"},[(u(!0),f(R,null,x(v,i=>(u(),f("div",{class:"word-wrapper",key:i.id,id:"line-".concat(i.verse_number),"data-hizb-number":i.hizb_number,"data-chapter-id":i.chapter_id,"data-juz-number":i.juz_number,"data-page-number":y,"data-verse-number":i.verse_number},[(u(!0),f(R,null,x(i.words,h=>(u(),f("span",{key:h.id,"data-word-position":h.position,class:"","data-hizb-number":i.hizb_number,"data-juz-number":i.juz_number,"data-chapter-id":i.chapter_id,"data-page-number":y},[P("span",{class:ve([B(h.location,h.verse_key)?"text-blue":"","word"])},[h.char_type_name==="end"?(u(),f("div",We,"("+_(h.text_uthmani)+") ",1)):(u(),f("h3",{key:1,style:te(s.styles)},_(h.text_uthmani),5))],2)],8,Ke))),128))],8,Fe))),128))],8,Me),a(e(U),{size:"12"},{default:t(()=>[a(e(ye),null,{default:t(()=>[a(e(A),{class:"m-auto"},{default:t(()=>[$(_(e(I)("quranReader.textPage"))+" "+_(y),1)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1032,["id"]))),128)),a(e(ne),{onIonInfinite:k},{default:t(()=>[a(e(se),{"loading-text":"Please wait...","loading-spinner":"bubbles"})]),_:1})]),_:1})],8,Ee)):Ie("",!0)}}),Je={class:"footer"},ta=q({__name:"Chapter",setup(D){const w=C("translations"),o=F(),b=xe(),{getLine:I}=O(),T=Re(),m=C(),S=C(),V=Ae(),B=C(),k=C(!1),s=N(()=>{var r;return(r=o.selectedChapter)==null?void 0:r.pagination}),g=C(null),v=N(()=>{var r;return(r=o.selectedChapterVerses)==null?void 0:r.sort((c,z)=>c.verse_number-z.verse_number)}),y=r=>{w.value=r.detail.value},i=E(),{chapterId:h}=i.params;G(async()=>{var r;if(h){o.selectedChapter=null;const c=o.chaptersList.find(z=>z.id===Number(h));c&&((r=c.verses)!=null&&r.length?o.selectedChapter=c:await o.getVerses(c.id,!0))}});const n=async r=>{await b.getAudio({audioID:r.audioID,verseKey:r.verseKey}),k.value=!0},d=async r=>{var c;r.nextPage&&o.selectedChapter&&await o.getVerses(o.selectedChapter.id,!0,(c=s.value)==null?void 0:c.next_page)},l=N(()=>({fontFamily:"var(--font-family-".concat(V.styles.value.fontFamily,")"),fontSize:"var(--font-size-".concat(V.styles.value.fontSize,")"),fontWeight:"var(--font-weight-".concat(V.styles.value.fontWeight,")")})),p=async()=>{var c,z;await(await ze.create({header:Le(String((c=T.selectedTranslation)==null?void 0:c.language_name)),message:(z=T.selectedTranslation)==null?void 0:z.author_name,id:"translation-alert",buttons:["Ok"]})).present()};ke(()=>S.value=m.value.$el);const le=async r=>{await o.getchapterInfo(r).then(c=>{g.value=c.data.chapter_info}),B.value.$el.click()};return(r,c)=>(u(),j(e(Ve),{"data-chapter-id":e(h),ref_key:"pageRef",ref:m},{default:t(()=>[a(e(we),null,{default:t(()=>[a(e(Ce),null,{default:t(()=>[a(e($e),{value:w.value,onIonChange:y},{default:t(()=>[a(e(W),{value:"translations"},{default:t(()=>[a(e(A),null,{default:t(()=>[$(_(e(I)("tabs.translations")),1)]),_:1})]),_:1}),a(e(W),{value:"reading"},{default:t(()=>[a(e(A),null,{default:t(()=>[$(_(e(I)("tabs.reading")),1)]),_:1})]),_:1})]),_:1},8,["value"])]),_:1})]),_:1}),a(e(M),null,{default:t(()=>[a(Oe,{id:"translations-chapters","is-loading":e(o).isLoading.verses,"is-playing":e(b).isPlaying,"is-translations-view":w.value==="translations","onUpdate:playAudio":n,"is-bismillah":e(o).selectedChapterBismillah,styles:l.value,verses:v.value,"chapter-name":e(o).selectedChapterName.nameArabic,"verse-timing":e(b).verseTiming,"onUpdate:getVerses":d,pagination:s.value,"onUpdate:modalValue":p,"audio-experience":e(b).audioPlayerSetting},null,8,["is-loading","is-playing","is-translations-view","is-bismillah","styles","verses","chapter-name","verse-timing","pagination","audio-experience"]),a(Ge,{id:"reading-chapters","is-reading-view":w.value==="reading","is-playing":e(b).isPlaying,verses:v.value,"is-loading":e(o).isLoading.verses,styles:l.value,"verse-timing":e(b).verseTiming,"onUpdate:getVerses":d,"onUpdate:surahInfo":le,pagination:s.value,"onUpdate:playAudio":n},null,8,["is-reading-view","is-playing","verses","is-loading","styles","verse-timing","pagination"]),P("div",null,[a(e(H),{ref_key:"chapterInfoModalRef",ref:B,id:"chapter-modal-info",class:"ion-hide"},null,512),a(Pe,{trigger:"chapter-modal-info","chapter-info":g.value,"page-el":S.value},null,8,["chapter-info","page-el"])])]),_:1}),P("div",Je,[a(Ne,{"model-value":k.value,"onUpdate:modelValue":c[0]||(c[0]=z=>k.value=z)},null,8,["model-value"])])]),_:1},8,["data-chapter-id"]))}});export{ta as default};
