import{_ as A,ax as B,A as i,Q as v,C as F,a7 as M}from"./index-CSnR3WyL.js";import{a as O,u as T,i as b,b as x}from"./ChapterStore-BzKdIpaO.js";const D=()=>new Promise((o,f)=>{try{A(()=>import("./juzs-to-chapters-BhKATkNw.js"),[]).then(r=>o(r.default))}catch(r){f(r)}}),Q=B("juz-store",()=>{const{selectedTranslation:o}=O(),{chaptersList:f}=T(),r=i(!1),l=i([]),t=i(null),d=i("asc"),u=i("id"),_=i(""),w=i(10),m=v(()=>o!=null&&o.id?String(o.id):"131"),S=v(()=>l.value.filter(e=>e.juz_number.toLocaleString().includes(_.value)).sort((e,a)=>{let s=1;return d.value==="desc"&&(s=-1),e[u.value]<a[u.value]?-1*s:e[u.value]>a[u.value]?1*s:0})),z=async(e,a,s,n)=>{r.value=a,s=s||1,n=n||w.value,await b.get(x("by_juz",e,m.value,s,n)).then(c=>{var g;const h=l.value.find(p=>p.juz_number===e);h&&(c.data.verses.forEach(p=>{var y,j;((y=h.verses)==null?void 0:y.find(k=>k.verse_key===p.verse_key))||(j=h.verses)==null||j.push({...p,bookmarked:!1})}),h.pagination=c.data.pagination,(g=t.value)!=null&&g.pagination&&(t.value.pagination=c.data.pagination))}).catch(c=>{throw c}).finally(()=>{r.value=!1})},J=async()=>{r.value=!0,await b.get("/juzs").then(e=>{const a=[...new Map(e.data.juzs.map(s=>[s.juz_number,s])).values()];a&&a.forEach(s=>{var n;(n=l.value)==null||n.push({...s,verses:[]})})}).catch(e=>{throw e}).finally(()=>{r.value=!1})};F(async()=>{l.value.length||await D().then(e=>e.forEach(a=>l.value.push(a)))});const L=v(()=>{var e;if(t.value&&t.value.verses)return(e=t.value)==null?void 0:e.verses.reduce((a,s)=>((a[s.chapter_id]=a[s.chapter_id]||[]).push(s),a),{})}),V=e=>{e===u.value&&(d.value=d.value==="asc"?"desc":"asc"),u.value=e};M(()=>m.value,async e=>{var a;e&&t.value&&(t.value.verses=[],await z((a=t.value)==null?void 0:a.id,!0,1))});const C=e=>{if(f){const a=f.find(s=>s.id===Number(e));if(a)return{ar:a.nameArabic,en:a.nameSimple,bismillah:a.bismillahPre}}},E=v(()=>{var e,a;if((e=t.value)!=null&&e.verses)return(a=t.value)==null?void 0:a.verses[0]}),P=v(()=>{var e;if(t.value){const a=(e=t.value.verses)==null?void 0:e.slice(-1)[0];if(a)return a.verse_number}return 0});return{isLoading:r,juzs:S,searchValue:_,selectedJuz:t,juzList:l,juzVersesByChapterMap:L,currentSort:u,currentSortDir:d,getFirstVerseOfJuz:E,getLastVerseOfJuz:P,getChapterNameByVerseKey:C,getJuzs:J,sort:V,getVerses:z}});export{Q as u};
