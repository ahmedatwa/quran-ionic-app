import{_ as C,aw as A,z as i,P as v,B as F,a5 as M}from"./index-CJnewdVb.js";import{a as O,u as T,i as w,b as D}from"./ChapterStore-CS45AkxF.js";const I=()=>new Promise((o,f)=>{try{C(()=>import("./juzs-to-chapters-BhKATkNw.js"),[]).then(r=>o(r.default))}catch(r){f(r)}}),R=A("juz-store",()=>{const{selectedTranslation:o}=O(),{chaptersList:f}=T(),r=i(!1),l=i([]),t=i(null),d=i("asc"),u=i("id"),z=i(""),b=i(10),_=v(()=>o!=null&&o.id?String(o.id):"131"),S=v(()=>l.value.filter(e=>e.juz_number.toLocaleString().includes(z.value)).sort((e,a)=>{let s=1;return d.value==="desc"&&(s=-1),e[u.value]<a[u.value]?-1*s:e[u.value]>a[u.value]?1*s:0})),m=async(e,a,s,n)=>{r.value=a,s=s||1,n=n||b.value,await w.get(D("by_juz",e,_.value,s,n)).then(c=>{var g;const h=l.value.find(p=>p.juz_number===e);h&&(c.data.verses.forEach(p=>{var y,j;((y=h.verses)==null?void 0:y.find(B=>B.verse_key===p.verse_key))||(j=h.verses)==null||j.push({...p,bookmarked:!1})}),h.pagination=c.data.pagination,(g=t.value)!=null&&g.pagination&&(t.value.pagination=c.data.pagination))}).catch(c=>{throw c}).finally(()=>{r.value=!1})},J=async()=>{r.value=!0,await w.get("/juzs").then(e=>{const a=[...new Map(e.data.juzs.map(s=>[s.juz_number,s])).values()];a&&a.forEach(s=>{var n;(n=l.value)==null||n.push({...s,verses:[]})})}).catch(e=>{throw e}).finally(()=>{r.value=!1})};F(async()=>{l.value.length||await I().then(e=>e.forEach(a=>l.value.push(a)))});const L=v(()=>{var e;if(t.value&&t.value.verses)return(e=t.value)==null?void 0:e.verses.reduce((a,s)=>((a[s.chapter_id]=a[s.chapter_id]||[]).push(s),a),{})}),P=e=>{e===u.value&&(d.value=d.value==="asc"?"desc":"asc"),u.value=e};M(()=>_.value,async e=>{var a;e&&t.value&&(t.value.verses=[],await m((a=t.value)==null?void 0:a.id,!0,1))});const V=e=>{if(f){const a=f.find(s=>s.id===Number(e));if(a)return{ar:a.nameArabic,en:a.nameSimple,bismillah:a.bismillahPre}}},E=v(()=>{var e,a;if((e=t.value)!=null&&e.verses)return(a=t.value)==null?void 0:a.verses[0]}),k=v(()=>{var e;if(t.value){const a=(e=t.value.verses)==null?void 0:e.slice(-1)[0];if(a)return a.verse_number}return 0});return{isLoading:r,juzs:S,searchValue:z,selectedJuz:t,juzList:l,juzVersesByChapterMap:L,currentSort:u,currentSortDir:d,getFirstVerseOfJuz:E,getLastVerseOfJuz:k,getChapterNameByVerseKey:V,getJuzs:J,sort:P,getVerses:m}});export{R as u};
