import{d as D,u as O,a3 as E,A as oe,z as C,P as N,C as G,a5 as re,a6 as W,a7 as ue,o as u,f,b as a,a as e,w as t,H as J,s as B,a8 as Y,v as x,a9 as Q,aa as X,j as L,k as $,t as h,ab as H,ac as de,ad as Z,ae as ee,af as ae,F as R,r as A,c as j,ag as ce,ah as pe,ai as q,q as me,aj as te,ak as ge,l as fe,g as he,an as ne,ao as ie,m as M,ap as _e,J as be,aq as ve,ar as ye,i as Ie,as as ke,$ as Ce,at as $e,au as K,a2 as we,n as Ve,av as ze}from"./index-CJnewdVb.js";import{_ as se,a as Te,v as Se,s as Pe,b as Be,A as Ne}from"./ChapterInfoModalComponent.vue_vue_type_script_setup_true_lang-Bzm30Kof.js";import{u as F,a as Re}from"./ChapterStore-CS45AkxF.js";import{u as Ae,a as Le}from"./ModalComponent.vue_vue_type_script_setup_true_lang-CY6DRNXA.js";import{p as xe}from"./string-BRzLPHJq.js";import"./_plugin-vue_export-helper-5Z20xKf-.js";const je=["id"],Ue={key:0,class:"end"},qe=["innerHTML"],De=D({__name:"TranslationsViewComponent",props:{id:{},isTranslationsView:{type:Boolean},isPlaying:{type:Boolean},isLoading:{type:Boolean},chapterName:{},isBismillah:{},verses:{},audioExperience:{},pagination:{},verseTiming:{},styles:{}},emits:["update:getVerses","update:playAudio","update:modalValue"],setup(U,{emit:w}){const{getLine:l}=O(),{params:b}=E(),{setStorage:I,bookmarkedItems:T}=oe("__bookmarksDB"),{getChapterName:m}=F(),S=C(),V=C(),P=N(()=>Number(b.chapterId)),k=C(),i=U,g=w,v=([{isIntersecting:n,target:d,intersectionRatio:o}])=>{if(n&&o>=.8){const p=Number(d.getAttribute("data-verse-number"));k.value=p}};G(async()=>{var n;i.audioExperience.autoScroll&&(k.value=Number((n=i.verseTiming)==null?void 0:n.verseNumber))}),re(k,n=>{n&&Pe("#verse-col-".concat(n),V.value.$el,300)});const y=async n=>{var d;T.value.push({key:"/page/".concat(n.page_number),value:{pageNumber:n.page_number,verseNumber:n.verse_number,verseText:n.text_uthmani,chapterName:(d=m(n.chapter_id))==null?void 0:d.nameSimple}}),T.value.forEach(({key:o,value:p})=>{I(o,p)})},s=n=>{var d;(d=i.pagination)!=null&&d.next_page?(g("update:getVerses",{key:i.id,nextPage:i.pagination.next_page}),setTimeout(()=>n.target.complete(),500)):n.target.complete()},_=n=>{if(i.verseTiming)return i.verseTiming.wordLocation===n.location};return(n,d)=>W((u(),f("div",{class:"ion-page",id:"translations-".concat(n.id,"-").concat(P.value)},[a(se,{"route-back-label":e(l)("tabs.chapters"),"is-loading":n.isLoading},null,8,["route-back-label","is-loading"]),a(e(M),{class:"quran-translation-content-wapper",fullscreen:!0,scrollY:!0,ref_key:"contentRef",ref:S},{default:t(()=>[a(e(J),{class:"ion-padding card-wrapper",ref_key:"cardRef",ref:V},{default:t(()=>[B("div",null,[a(e(Y),{onClick:d[0]||(d[0]=o=>n.$emit("update:playAudio",{audioID:P.value})),color:"primary",class:"ion-float-right"},{default:t(()=>[a(e(x),{color:"primary",icon:n.isPlaying?e(Q):e(X)},null,8,["icon"]),a(e(L),null,{default:t(()=>[$(h(e(l)("quranReader.buttonPlay")),1)]),_:1})]),_:1}),a(e(H),{onClick:d[1]||(d[1]=o=>n.$emit("update:modalValue",!0)),fill:"clear"},{default:t(()=>[a(e(x),{icon:e(de),slot:"icon-only"},null,8,["icon"])]),_:1})]),a(e(Z),{class:"ion-text-center"},{default:t(()=>[a(e(ee),null,{default:t(()=>[$(h(n.isBismillah),1)]),_:1}),a(e(ae),null,{default:t(()=>[$(h(n.chapterName),1)]),_:1})]),_:1}),(u(!0),f(R,null,A(n.verses,o=>W((u(),j(e(he),{key:o.verse_number,"data-verse-number":o.verse_number,"data-hizb-number":o.hizb_number,"data-juz-number":o.juz_number,id:"verse-col-".concat(o.verse_number)},{default:t(()=>[a(e(ce),null,{default:t(()=>[a(e(pe),{class:"ion-align-items-start"},{default:t(()=>[a(e(q),{size:"11",class:"translations-view-col"},{default:t(()=>[(u(!0),f(R,null,A(o.words,p=>(u(),j(e(L),{key:p.id},{default:t(()=>[a(e(me),{color:_(p)?"primary":""},{default:t(()=>[p.char_type_name==="end"?(u(),f("span",Ue," ("+h(p.text_uthmani)+")",1)):(u(),f("h3",{key:1,style:te(n.styles)},h(p.text_uthmani),5))]),_:2},1032,["color"])]),_:2},1024))),128))]),_:2},1024),a(e(q),{size:"1",class:"action-sheet"},{default:t(()=>[a(e(x),{icon:e(ge),color:"primary",id:"open-action-sheet".concat(o.verse_number)},null,8,["icon","id"]),a(Te,{verse:o,"trigger-prop":"open-action-sheet".concat(o.verse_number),"onUpdate:bookmarked":y,"onUpdate:playVerseAudio":d[2]||(d[2]=p=>n.$emit("update:playAudio",{...p}))},null,8,["verse","trigger-prop"])]),_:2},1024),a(e(q),{size:"12",class:"ion-text-left"},{default:t(()=>[(u(!0),f(R,null,A(o.translations,p=>(u(),j(e(fe),{key:p.id,class:"translation"},{default:t(()=>[B("span",{innerHTML:p.text},null,8,qe)]),_:2},1024))),128))]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1032,["data-verse-number","data-hizb-number","data-juz-number","id"])),[[e(Se),[v,{root:S.value,immediate:!1}]]])),128))]),_:1},512),a(e(ne),{onIonInfinite:s},{default:t(()=>[a(e(ie),{"loading-text":"Please wait...","loading-spinner":"bubbles"})]),_:1})]),_:1},512)],8,je)),[[ue,n.isTranslationsView]])}}),Oe=["id"],Ee=["id"],He=["id","data-hizb-number","data-chapter-id","data-juz-number","data-page-number","data-verse-number"],Me=["data-word-position","data-hizb-number","data-juz-number","data-chapter-id","data-page-number"],Fe={key:0,class:"end"},We=D({__name:"ReadingViewComponent",props:{id:{},isReadingView:{type:Boolean},isPlaying:{type:Boolean},verseTiming:{},verses:{},isLoading:{type:Boolean},pagination:{},styles:{}},emits:["update:getVerses","update:playAudio","update:surahInfo"],setup(U,{emit:w}){const{params:l}=E(),{getChapterNameByFirstVerse:b}=F(),{getLine:I}=O(),T=N(()=>Number(l.chapterId)),m=U,S=w,V=N(()=>{if(m.verses)return m.verses.reduce((i,g)=>((i[g.page_number]=i[g.page_number]||[]).push(g),i),{})}),P=(i,g)=>{if(m.isReadingView&&m.verseTiming)return m.verseTiming.wordLocation===i&&g===m.verseTiming.verseKey},k=i=>{var g;(g=m.pagination)!=null&&g.next_page?(S("update:getVerses",{key:m.id,nextPage:m.pagination.next_page}),setTimeout(()=>i.target.complete(),500)):i.target.complete()};return(i,g)=>i.isReadingView?(u(),f("div",{key:0,class:"ion-page",id:"".concat(i.id,"-").concat(T.value)},[a(se,{"is-loading":i.isLoading,"route-back-label":e(I)("tabs.chapters")},null,8,["is-loading","route-back-label"]),a(e(M),null,{default:t(()=>[(u(!0),f(R,null,A(V.value,(v,y)=>(u(),j(e(J),{class:"ion-padding",key:y,id:"row-page-".concat(y)},{default:t(()=>[B("div",null,[a(e(Y),{onClick:s=>i.$emit("update:playAudio",{audioID:v[0].chapter_id}),color:"primary",class:"ion-float-right"},{default:t(()=>[a(e(x),{icon:i.isPlaying?e(Q):e(X)},null,8,["icon"]),a(e(L),null,{default:t(()=>[$(h(e(I)("quranReader.buttonPlay")),1)]),_:1})]),_:2},1032,["onClick"]),a(e(H),{fill:"clear",onClick:s=>i.$emit("update:surahInfo",v[0].chapter_id)},{default:t(()=>[a(e(x),{icon:e(_e),slot:"icon-only"},null,8,["icon"])]),_:2},1032,["onClick"])]),a(e(Z),{class:"ion-text-center"},{default:t(()=>[a(e(ee),null,{default:t(()=>{var s;return[$(h((s=e(b)(v[0]))!=null&&s.bismillahPre?e(I)("quranReader.textBismillah"):""),1)]}),_:2},1024),a(e(ae),null,{default:t(()=>{var s;return[$(h((s=e(b)(v[0]))==null?void 0:s.nameArabic),1)]}),_:2},1024)]),_:2},1024),a(e(be),{class:"ion-padding quran-reader-content-wrapper"},{default:t(()=>[B("div",{class:"verse-col",id:"page-".concat(y),size:"12"},[(u(!0),f(R,null,A(v,s=>(u(),f("div",{class:"word-wrapper",key:s.id,id:"line-".concat(s.verse_number),"data-hizb-number":s.hizb_number,"data-chapter-id":s.chapter_id,"data-juz-number":s.juz_number,"data-page-number":y,"data-verse-number":s.verse_number},[(u(!0),f(R,null,A(s.words,_=>(u(),f("span",{key:_.id,"data-word-position":_.position,class:"","data-hizb-number":s.hizb_number,"data-juz-number":s.juz_number,"data-chapter-id":s.chapter_id,"data-page-number":y},[B("span",{class:ve([P(_.location,_.verse_key)?"text-blue":"","word"])},[_.char_type_name==="end"?(u(),f("div",Fe,"("+h(_.text_uthmani)+") ",1)):(u(),f("h3",{key:1,style:te(i.styles)},h(_.text_uthmani),5))],2)],8,Me))),128))],8,He))),128))],8,Ee),a(e(q),{size:"12"},{default:t(()=>[a(e(ye),null,{default:t(()=>[a(e(L),{class:"m-auto"},{default:t(()=>[$(h(e(I)("quranReader.textPage"))+" "+h(y),1)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1032,["id"]))),128)),a(e(ne),{onIonInfinite:k},{default:t(()=>[a(e(ie),{"loading-text":"Please wait...","loading-spinner":"bubbles"})]),_:1})]),_:1})],8,Oe)):Ie("",!0)}}),Ke={class:"footer"},ea=D({__name:"Chapter",setup(U){const w=C("translations"),l=F(),b=Ae(),{getLine:I}=O(),T=Re(),m=C(),S=C(),V=Le(),P=C(),k=C(!1),i=N(()=>{var r;return(r=l.selectedChapter)==null?void 0:r.pagination}),g=C(null),v=N(()=>{var r;return(r=l.selectedChapterVerses)==null?void 0:r.sort((c,z)=>c.verse_number-z.verse_number)}),y=r=>{w.value=r.detail.value},s=E(),{chapterId:_}=s.params;G(async()=>{var r;if(_){l.selectedChapter=null;const c=l.chaptersList.find(z=>z.id===Number(_));c&&((r=c.verses)!=null&&r.length?l.selectedChapter=c:await l.getVerses(c.id,!0))}});const n=async r=>{await b.getAudio({audioID:r.audioID,verseKey:r.verseKey}),k.value=!0},d=async r=>{var c;r.nextPage&&l.selectedChapter&&await l.getVerses(l.selectedChapter.id,!0,(c=i.value)==null?void 0:c.next_page)},o=N(()=>({fontFamily:"var(--font-family-".concat(V.styles.value.fontFamily,")"),fontSize:"var(--font-size-".concat(V.styles.value.fontSize,")"),fontWeight:"var(--font-weight-".concat(V.styles.value.fontWeight,")")})),p=async()=>{var c,z;await(await ze.create({header:xe(String((c=T.selectedTranslation)==null?void 0:c.language_name)),message:(z=T.selectedTranslation)==null?void 0:z.author_name,id:"translation-alert",buttons:["Ok"]})).present()};ke(()=>S.value=m.value.$el);const le=async r=>{await l.getchapterInfo(r).then(c=>{g.value=c.data.chapter_info}),P.value.$el.click()};return(r,c)=>(u(),j(e(Ve),{"data-chapter-id":e(_),ref_key:"pageRef",ref:m},{default:t(()=>[a(e(we),null,{default:t(()=>[a(e(Ce),null,{default:t(()=>[a(e($e),{value:w.value,onIonChange:y},{default:t(()=>[a(e(K),{value:"translations"},{default:t(()=>[a(e(L),null,{default:t(()=>[$(h(e(I)("tabs.translations")),1)]),_:1})]),_:1}),a(e(K),{value:"reading"},{default:t(()=>[a(e(L),null,{default:t(()=>[$(h(e(I)("tabs.reading")),1)]),_:1})]),_:1})]),_:1},8,["value"])]),_:1})]),_:1}),a(e(M),null,{default:t(()=>[a(De,{id:"translations-chapters","is-loading":e(l).isLoading.verses,"is-playing":e(b).isPlaying,"is-translations-view":w.value==="translations","onUpdate:playAudio":n,"is-bismillah":e(l).selectedChapterBismillah,styles:o.value,verses:v.value,"chapter-name":e(l).selectedChapterName.nameArabic,"verse-timing":e(b).verseTiming,"onUpdate:getVerses":d,pagination:i.value,"onUpdate:modalValue":p,"audio-experience":e(b).audioPlayerSetting},null,8,["is-loading","is-playing","is-translations-view","is-bismillah","styles","verses","chapter-name","verse-timing","pagination","audio-experience"]),a(We,{id:"reading-chapters","is-reading-view":w.value==="reading","is-playing":e(b).isPlaying,verses:v.value,"is-loading":e(l).isLoading.verses,styles:o.value,"verse-timing":e(b).verseTiming,"onUpdate:getVerses":d,"onUpdate:surahInfo":le,pagination:i.value,"onUpdate:playAudio":n},null,8,["is-reading-view","is-playing","verses","is-loading","styles","verse-timing","pagination"]),B("div",null,[a(e(H),{ref_key:"chapterInfoModalRef",ref:P,id:"chapter-modal-info",class:"ion-hide"},null,512),a(Be,{trigger:"chapter-modal-info","chapter-info":g.value,"page-el":S.value},null,8,["chapter-info","page-el"])])]),_:1}),B("div",Ke,[a(Ne,{"model-value":k.value,"onUpdate:modelValue":c[0]||(c[0]=z=>k.value=z)},null,8,["model-value"])])]),_:1},8,["data-chapter-id"]))}});export{ea as default};
