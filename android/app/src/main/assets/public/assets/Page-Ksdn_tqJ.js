import{d as G,u as J,A as me,a3 as M,a4 as Z,z as B,P as R,a5 as fe,a6 as Q,a7 as _e,o as i,f as c,b as a,w as t,F as N,r as A,c as q,s as j,a as e,a8 as ee,v as V,a9 as ae,aa as te,j as O,k as w,t as p,ab as L,ac as be,ad as ve,ae as he,af as ye,g as ke,ag as ne,ah as ie,ai as F,q as Ie,aj as se,ak as $e,l as Ce,al as le,am as oe,i as W,H as re,an as ue,ao as de,m as Y,ap as we,J as ze,aq as Pe,ar as Ve,C as Se,as as Te,$ as Be,at as Re,au as X,a2 as Ne,n as Ae,av as Le}from"./index-CJnewdVb.js";import{_ as ce,a as xe,v as qe,s as je,b as Oe,A as Ue}from"./ChapterInfoModalComponent.vue_vue_type_script_setup_true_lang-Bzm30Kof.js";import{u as E,p as De}from"./string-BRzLPHJq.js";import{u as pe,a as Fe}from"./ChapterStore-CS45AkxF.js";import{u as He}from"./PageStore-ni_RSGYU.js";import{a as Ee,u as Ke}from"./ModalComponent.vue_vue_type_script_setup_true_lang-CY6DRNXA.js";import"./_plugin-vue_export-helper-5Z20xKf-.js";const We=["id"],Ge=j("hr",null,null,-1),Je={key:0,class:"end"},Me=["innerHTML"],Ye={key:0,class:"ion-margin-top"},Qe=G({__name:"TranslationsViewComponent",props:{id:{},isTranslationsView:{type:Boolean},isPlaying:{type:Boolean},isLoading:{type:Boolean},translatedBy:{},chapterName:{},isBismillah:{},verses:{},pagination:{},verseTiming:{},styles:{}},emits:["update:getVerses","update:playAudio","update:modalValue"],setup(H,{emit:S}){const{getLine:l}=J(),{getChapterNameByFirstVerse:T,getChapterName:k}=pe(),{setStorage:I,bookmarkedItems:_}=me("__bookmarksDB"),{params:U}=M(),x=Z(),$=B(),b=R(()=>Number(U.pageId)),u=B(),g=H,z=S,C=([{isIntersecting:n,target:m,intersectionRatio:h}])=>{if(n&&h>=.8){const P=Number(m.getAttribute("data-verse-number"));u.value=P}};fe(u,n=>{n&&je("#verse-col-".concat(n),$.value.$el,300)});const d=async n=>{var m;_.value.push({key:"/page/".concat(n.page_number),value:{pageNumber:n.page_number,verseNumber:n.verse_number,verseText:n.text_uthmani,chapterName:(m=k(n.chapter_id))==null?void 0:m.nameSimple}}),_.value.forEach(({key:h,value:P})=>{I(h,P)})},v=n=>{var m;(m=g.pagination)!=null&&m.next_page?(z("update:getVerses",{key:g.id,nextPage:g.pagination.next_page}),setTimeout(()=>n.target.complete(),500)):n.target.complete()},K=n=>{if(g.verseTiming)return g.verseTiming.wordLocation===n.location},D=R(()=>x.options.history.state.back?E(x.options.history.state.back.toString().substring(1)):E(l("tabs.pages")));return(n,m)=>Q((i(),c("div",{class:"ion-page",id:"translations-".concat(n.id,"-").concat(b.value)},[a(ce,{"route-back-label":D.value,"is-loading":n.isLoading},null,8,["route-back-label","is-loading"]),a(e(Y),{class:"quran-translation-content-wapper",fullscreen:!0,scrollY:!0,ref:"contentRef"},{default:t(()=>[(i(!0),c(N,null,A(n.verses,(h,P)=>(i(),q(e(re),{class:"ion-padding card-wrapper",key:P,id:"card-".concat(P),ref_for:!0,ref_key:"cardRef",ref:$},{default:t(()=>[j("div",null,[a(e(ee),{onClick:s=>n.$emit("update:playAudio",{audioID:h[0].chapter_id,verseKey:h[0].verse_key}),color:"primary",class:"ion-float-right"},{default:t(()=>[a(e(V),{icon:n.isPlaying?e(ae):e(te)},null,8,["icon"]),a(e(O),null,{default:t(()=>[w(p(e(l)("quranReader.buttonPlay")),1)]),_:1})]),_:2},1032,["onClick"]),a(e(L),{onClick:m[0]||(m[0]=s=>n.$emit("update:modalValue",!0)),fill:"clear"},{default:t(()=>[a(e(V),{icon:e(be),slot:"icon-only"},null,8,["icon"])]),_:1})]),a(e(ve),{class:"ion-text-center"},{default:t(()=>[a(e(he),null,{default:t(()=>{var s;return[w(p((s=e(T)(h[0]))!=null&&s.bismillahPre?e(l)("quranReader.textBismillah"):""),1)]}),_:2},1024),a(e(ye),null,{default:t(()=>{var s;return[w(p((s=e(T)(h[0]))==null?void 0:s.nameArabic),1)]}),_:2},1024)]),_:2},1024),Ge,(i(!0),c(N,null,A(h,s=>Q((i(),q(e(ke),{key:s.verse_number,"data-verse-number":s.verse_number,"data-hizb-number":s.hizb_number,"data-juz-number":s.juz_number,id:"verse-col-".concat(s.verse_number)},{default:t(()=>[a(e(ne),null,{default:t(()=>[a(e(ie),{class:"ion-align-items-start"},{default:t(()=>[a(e(F),{size:"11",class:"translations-view-col"},{default:t(()=>[(i(!0),c(N,null,A(s.words,y=>(i(),q(e(O),{key:y.id,class:"word"},{default:t(()=>[a(e(Ie),{color:K(y)?"primary":""},{default:t(()=>[y.char_type_name==="end"?(i(),c("h3",Je," ("+p(y.text_uthmani)+")",1)):(i(),c("h3",{key:1,style:se(n.styles)},p(y.text_uthmani),5))]),_:2},1032,["color"])]),_:2},1024))),128))]),_:2},1024),a(e(F),{size:"1",class:"action-sheet"},{default:t(()=>[a(e(V),{icon:e($e),color:"primary",id:"open-action-sheet".concat(s.verse_number)},null,8,["icon","id"]),a(xe,{verse:s,"trigger-prop":"open-action-sheet".concat(s.verse_number),"onUpdate:bookmarked":d,"onUpdate:playVerseAudio":m[1]||(m[1]=y=>n.$emit("update:playAudio",y))},null,8,["verse","trigger-prop"])]),_:2},1024),a(e(F),{size:"12",class:"ion-text-left"},{default:t(()=>[(i(!0),c(N,null,A(s.translations,y=>(i(),q(e(Ce),{key:y.id,class:"translation"},{default:t(()=>[j("span",{innerHTML:y.text},null,8,Me)]),_:2},1024))),128))]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1032,["data-verse-number","data-hizb-number","data-juz-number","id"])),[[e(qe),[C,{root:$.value,immediate:!1}]]])),128)),b.value?(i(),c("div",Ye,[a(e(L),{size:"small",fill:"clear",disabled:b.value===1,"router-link":"/page/".concat(b.value-1)},{default:t(()=>[a(e(V),{icon:e(le),slot:"start"},null,8,["icon"]),w(" "+p(e(l)("quranReader.prevPage")),1)]),_:1},8,["disabled","router-link"]),a(e(L),{size:"small",fill:"clear",disabled:b.value===604,class:"ion-float-right","router-link":"/page/".concat(b.value+1)},{default:t(()=>[a(e(V),{icon:e(oe),slot:"start"},null,8,["icon"]),w(" "+p(e(l)("quranReader.nextPage")),1)]),_:1},8,["disabled","router-link"])])):W("",!0)]),_:2},1032,["id"]))),128)),a(e(ue),{onIonInfinite:v},{default:t(()=>[a(e(de),{"loading-text":"Please wait...","loading-spinner":"bubbles"})]),_:1})]),_:1},512)],8,We)),[[_e,n.isTranslationsView]])}}),Xe=["id"],Ze=["id","data-hizb-number","data-chapter-id","data-juz-number","data-page-number","data-verse-number"],ea=["data-word-position","data-hizb-number","data-juz-number","data-chapter-id","data-page-number"],aa={key:0,class:"end"},ta={key:0,class:"ion-margin-top"},na=G({__name:"ReadingViewComponent",props:{id:{},isReadingView:{type:Boolean},isPlaying:{type:Boolean},verseTiming:{},verses:{},isLoading:{type:Boolean},pagination:{},styles:{}},emits:["update:getv","update:playAudio","update:surahInfo"],setup(H,{emit:S}){const l=M(),T=Z(),{getLine:k}=J(),I=R(()=>Number(l.params.pageId)),_=H,U=S,x=(u,g)=>{if(_.isReadingView&&_.verseTiming)return _.verseTiming.wordLocation===u&&g===_.verseTiming.verseKey},$=u=>{var g;(g=_.pagination)!=null&&g.next_page?(U("update:getv",{key:_.id,nextPage:_.pagination.next_page}),setTimeout(()=>u.target.complete(),500)):u.target.complete()},b=R(()=>T.options.history.state.back?E(T.options.history.state.back.toString().substring(1)):E(k("tabs.pages")));return(u,g)=>u.isReadingView?(i(),c("div",{key:0,class:"ion-page",id:"".concat(u.id,"-").concat(I.value)},[a(ce,{"is-loading":u.isLoading,"route-back-label":b.value},null,8,["is-loading","route-back-label"]),a(e(Y),null,{default:t(()=>[(i(!0),c(N,null,A(u.verses,(z,C)=>(i(),q(e(re),{class:"ion-padding",key:C,id:"row-page-".concat(C)},{default:t(()=>[j("div",null,[a(e(ee),{onClick:d=>u.$emit("update:playAudio",{audioID:z[0].chapter_id,verseKey:z[0].verse_key}),color:"primary",class:"ion-float-right"},{default:t(()=>[a(e(V),{icon:u.isPlaying?e(ae):e(te)},null,8,["icon"]),a(e(O),null,{default:t(()=>[w(p(e(k)("quranReader.buttonPlay")),1)]),_:1})]),_:2},1032,["onClick"]),a(e(L),{fill:"clear",onClick:d=>u.$emit("update:surahInfo",z[0].chapter_id)},{default:t(()=>[a(e(V),{icon:e(we),slot:"icon-only"},null,8,["icon"])]),_:2},1032,["onClick"])]),a(e(ze),{class:"ion-padding quran-reader-content-wrapper"},{default:t(()=>[a(e(ne),null,{default:t(()=>[a(e(ie),null,{default:t(()=>[a(e(F),{class:"verse-col",id:"page-".concat(C),size:"12"},{default:t(()=>[(i(!0),c(N,null,A(z,d=>(i(),c("div",{class:"word-wrapper",key:d.id,id:"line-".concat(d.verse_number),"data-hizb-number":d.hizb_number,"data-chapter-id":d.chapter_id,"data-juz-number":d.juz_number,"data-page-number":C,"data-verse-number":d.verse_number},[(i(!0),c(N,null,A(d.words,v=>(i(),c("div",{key:v.id,"data-word-position":v.position,class:"flex","data-hizb-number":d.hizb_number,"data-juz-number":d.juz_number,"data-chapter-id":d.chapter_id,"data-page-number":C},[j("span",{class:Pe([x(v.location,v.verse_key)?"text-blue":"","word"])},[v.char_type_name==="end"?(i(),c("div",aa,"("+p(v.text_uthmani)+") ",1)):(i(),c("h3",{key:1,style:se(u.styles)},p(v.text_uthmani),5))],2)],8,ea))),128))],8,Ze))),128))]),_:2},1032,["id"]),a(e(F),{size:"12"},{default:t(()=>[a(e(Ve),null,{default:t(()=>[a(e(O),{class:"m-auto"},{default:t(()=>[w(p(e(k)("quranReader.textPage"))+" "+p(C),1)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024),I.value?(i(),c("div",ta,[a(e(L),{size:"small",fill:"clear",disabled:I.value===1,"router-link":"/page/".concat(I.value-1)},{default:t(()=>[a(e(V),{icon:e(le),slot:"start"},null,8,["icon"]),w(" "+p(e(k)("quranReader.prevPage")),1)]),_:1},8,["disabled","router-link"]),a(e(L),{size:"small",fill:"clear",disabled:I.value===604,class:"ion-float-right","router-link":"/page/".concat(I.value+1)},{default:t(()=>[a(e(V),{icon:e(oe),slot:"start"},null,8,["icon"]),w(" "+p(e(k)("quranReader.nextPage")),1)]),_:1},8,["disabled","router-link"])])):W("",!0)]),_:2},1032,["id"]))),128)),a(e(ue),{onIonInfinite:$},{default:t(()=>[a(e(de),{"loading-text":"Please wait...","loading-spinner":"bubbles"})]),_:1})]),_:1})],8,Xe)):W("",!0)}}),ca=G({__name:"Page",setup(H){const S=B("translations"),l=He(),{getLine:T}=J(),k=Ee(),I=Fe(),{selectedChapterName:_,selectedChapterBismillah:U,getchapterInfo:x}=pe(),$=Ke(),b=B(!1),u=o=>{S.value=o.detail.value},g=R(()=>{var o;return(o=l.selectedPage)==null?void 0:o.pagination}),z=B(),C=B(),d=B(null),v=B(),K=M(),{pageId:D}=K.params;Se(async()=>{var o;if(D){l.selectedPage=null;const r=l.pagesList.find(f=>f.pageNumber===Number(D));r&&((o=r.verses)!=null&&o.length?l.selectedPage=r:await l.getVerses(r.pageNumber,!0))}});const n=async o=>{await $.getAudio({audioID:o.audioID,verseKey:o.verseKey}),b.value=!0},m=async o=>{var r,f;o.nextPage&&l.selectedPage&&await l.getVerses((r=l.selectedPage)==null?void 0:r.pageNumber,!0,(f=g.value)==null?void 0:f.next_page)},h=R(()=>({fontFamily:"var(--font-family-".concat(k.styles.value.fontFamily,")"),fontSize:"var(--font-size-".concat(k.styles.value.fontSize,")"),fontWeight:"var(--font-weight-".concat(k.styles.value.fontWeight,")")})),P=R(()=>{if(l.selectedPage)return l.selectedPage.verses}),s=R(()=>{var o;if(P.value)return(o=P.value)==null?void 0:o.reduce((r,f)=>((r[f.chapter_id]=r[f.chapter_id]||[]).push(f),r),{})}),y=async o=>{await x(o).then(r=>{d.value=r.data.chapter_info}),v.value.$el.click()},ge=async()=>{var r,f;await(await Le.create({header:De(String((r=I.selectedTranslation)==null?void 0:r.language_name)),message:(f=I.selectedTranslation)==null?void 0:f.author_name,id:"translation-alert",buttons:["Ok"]})).present()};return Te(()=>C.value=z.value.$el),(o,r)=>(i(),q(e(Ae),{"data-page-id":e(D),ref_key:"pageRef",ref:z},{default:t(()=>[a(e(Ne),null,{default:t(()=>[a(e(Be),null,{default:t(()=>[a(e(Re),{value:S.value,onIonChange:u},{default:t(()=>[a(e(X),{value:"translations"},{default:t(()=>[a(e(O),null,{default:t(()=>[w(p(e(T)("tabs.translations")),1)]),_:1})]),_:1}),a(e(X),{value:"reading"},{default:t(()=>[a(e(O),null,{default:t(()=>[w(p(e(T)("tabs.reading")),1)]),_:1})]),_:1})]),_:1},8,["value"])]),_:1})]),_:1}),a(e(Y),null,{default:t(()=>[a(Qe,{id:"translations-pages","is-loading":e(l).isLoading,"is-playing":e($).isPlaying,"is-translations-view":S.value==="translations","onUpdate:playAudio":n,"is-bismillah":e(U),styles:h.value,verses:s.value,"chapter-name":e(_).nameArabic,"onUpdate:modalValue":ge,"verse-timing":e($).verseTiming,"onUpdate:getVerses":m,pagination:g.value},null,8,["is-loading","is-playing","is-translations-view","is-bismillah","styles","verses","chapter-name","verse-timing","pagination"]),a(na,{id:"reading-pages","is-reading-view":S.value==="reading","is-playing":e($).isPlaying,verses:s.value,"onUpdate:playAudio":n,"onUpdate:surahInfo":y,"is-loading":e(l).isLoading,styles:h.value,"verse-timing":e($).verseTiming,"onUpdate:getVerses":m,pagination:g.value},null,8,["is-reading-view","is-playing","verses","is-loading","styles","verse-timing","pagination"]),j("div",null,[a(e(L),{ref_key:"chapterInfoButtonRef",ref:v,id:"page-chapter-modal",class:"ion-hide"},null,512),a(Oe,{trigger:"page-chapter-modal","chapter-info":d.value,"page-el":C.value},null,8,["chapter-info","page-el"])])]),_:1}),a(Ue,{"model-value":b.value,"onUpdate:modelValue":r[0]||(r[0]=f=>b.value=f)},null,8,["model-value"])]),_:1},8,["data-page-id"]))}});export{ca as default};
