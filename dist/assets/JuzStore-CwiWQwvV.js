import{af as O,O as o,m as d,ah as T,ag as F}from"./index-BxKZXudA.js";import{a as I,u as N,i as j,b as E}from"./ChapterStore-BCWT5l7E.js";import{_ as P}from"./number-50Ioylus.js";const K=O("juz-store",()=>{const m=I(),{chaptersList:h}=N(),c=o(!1),v=o([]),r=o(null),p=o("asc"),u=o("id"),g=o(""),S=o(10),w=d(()=>{if(r.value)return Object.entries(r.value.verse_mapping).map(s=>{const a=s[1].split("-");return{chapterId:s[0],versesRange:{from:a[0],to:a[1]},verses:P(Number(a[1]),Number(a[0])).map(t=>{var i,f;const n=(f=(i=r.value)==null?void 0:i.verses)==null?void 0:f.find(l=>l.verse_number===t);return n||null})}})}),J=d(()=>v.value.filter(e=>e.juz_number.toLocaleString().includes(g.value)).sort((e,s)=>{let a=1;return p.value==="desc"&&(a=-1),e[u.value]<s[u.value]?-1*a:e[u.value]>s[u.value]?1*a:0})),z=async(e,s,a,t)=>{c.value=s,a=a||1,t=t||S.value,await j.get(E("by_juz",e,m.selectedTranslationsIdsString,a,t)).then(n=>{var f;const i=v.value.find(l=>l.juz_number===e);i&&(n.data.verses.forEach(l=>{var b,y;((b=i.verses)==null?void 0:b.find(M=>M.verse_key===l.verse_key))||(y=i.verses)==null||y.push({...l,bookmarked:!1})}),i.pagination=n.data.pagination,(f=r.value)!=null&&f.pagination&&(r.value.pagination=n.data.pagination))}).catch(n=>{throw n}).finally(()=>{c.value=!1})},_=async()=>{c.value=!0,await j.get("/juzs").then(e=>{const s=[...new Map(e.data.juzs.map(a=>[a.juz_number,a])).values()];s&&s.forEach(a=>{var t;(t=v.value)==null||t.push({...a,verses:[]})})}).catch(e=>{throw e}).finally(()=>{c.value=!1})};T(async()=>{v.value.length||await _()});const V=d(()=>{var e;if(r.value&&r.value.verses)return(e=r.value)==null?void 0:e.verses.reduce((s,a)=>((s[a.chapter_id]=s[a.chapter_id]||[]).push(a),s),{})}),L=e=>{e===u.value&&(p.value=p.value==="asc"?"desc":"asc"),u.value=e};F(()=>m.selectedTranslationsIdsString,async e=>{var s;e&&r.value&&(r.value.verses=[],await z((s=r.value)==null?void 0:s.id,!0,1))});const k=e=>{if(h){const s=h.find(a=>a.id===Number(e));if(s)return{ar:s.nameArabic,en:s.nameSimple,bismillah:s.bismillahPre}}},B=d(()=>{var e,s;if((e=r.value)!=null&&e.verses)return(s=r.value)==null?void 0:s.verses[0]}),C=d(()=>{var e;if(r.value){const s=(e=r.value.verses)==null?void 0:e.slice(-1)[0];if(s)return s.verse_number}return 0});return{isLoading:c,juzs:J,JuzMapByChaptersTest:w,searchValue:g,selectedJuz:r,juzList:v,juzVersesByChapterMap:V,currentSort:u,currentSortDir:p,getFirstVerseOfJuz:B,getLastVerseOfJuz:C,getChapterNameByVerseKey:k,getJuzs:_,sort:L,getVerses:z}});export{K as u};
