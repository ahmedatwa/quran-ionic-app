import{af as C,O as i,m as v,R as w,ag as z}from"./index-BxKZXudA.js";import{a as I,u as T,i as V,b as k}from"./ChapterStore-BCWT5l7E.js";import E from"./chapters-DjdraJUP.js";import{l as O}from"./number-50Ioylus.js";const j=604,D=s=>{const n=[],t=E.chapters.find(u=>u.id===Number(s));return t&&n.push({id:t.id,nameArabic:t.nameArabic,nameSimple:t.nameSimple}),n},M=(s="en")=>[...Array(j)].map((n,t)=>{const u=t+1;return{pageNumber:Number(O(u,s)),verses:[],pagination:null,chaptersMap:D(u),audioFile:null}}),H=C("page-store",()=>{const s=i(!1),n=i(10),t=I(),{getChapterNameByChapterId:u}=T(),e=i(null),m=i(),f=i(""),l=i([]),S=v(()=>{if(l.value)return s.value=!0,setTimeout(()=>{s.value=!1},500),l.value.filter(a=>a.pageNumber.toLocaleString().includes(f.value.toLocaleLowerCase()))}),d=async(a,c,F=1,L=n.value)=>{s.value=c,m.value=a,await V.get(k("by_page",a,t.selectedTranslationsIdsString,F,L)).then(g=>{var b,h;const r=(b=l.value)==null?void 0:b.find(p=>p.pageNumber===a);r&&(g.data.verses.forEach(p=>{var N,_;((N=r.verses)==null?void 0:N.find(A=>A.verse_key===p.verse_key))||(_=r.verses)==null||_.push({...p,bookmarked:!1})}),r.pagination=g.data.pagination,((h=e.value)==null?void 0:h.pageNumber)===r.pageNumber&&e.value&&(e.value.verses=r.verses,e.value.pagination=r.pagination))}).catch(g=>{throw g}).finally(()=>{s.value=!1})};w(()=>{const a=M();a&&(l.value=a)}),z(()=>t.selectedTranslationsIdsString,async a=>{var c;a&&e.value&&(e.value.verses=[],await d((c=e.value)==null?void 0:c.pageNumber,!0))});const o=v(()=>{if(e.value)return e.value.verses[0]}),P=v(()=>{if(e.value)return e.value.verses.slice(-1)[0]}),y=v(()=>{if(o.value)return{left:u(o.value.chapter_id),right:{pageNumber:o.value.page_number,hizbNumber:o.value.hizb_number,juzNumber:o.value.juz_number}}});return{pages:S,pagesList:l,perPage:n,isLoading:s,selectedPage:e,selectedPageId:m,searchValue:f,getLastVerseOfPage:P,getFirstVerseOfPage:o,getInitialHeaderData:y,getVerses:d}});export{H as u};
